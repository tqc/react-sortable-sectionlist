(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,n){e.exports=n(55)},32:function(e,t,n){},34:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(26),o=n.n(r),l=(n(32),n(1)),s=n(2),c=n(4),u=n(3),d=n(5),h=(n(34),n(8)),m=n(6);function p(e,t,n,i){var a=function(e,t,n){for(var i=0,a=0;a<e.length;a++){var r=e[a];if(i+r.height>n)return{row:r,rowIndex:a,yOffset:n-i};i+=r.height}}(e,0,n);if(!a.row)return a;if(1===a.row.items.length)return a.item=a.row.items[0],a.xOffset=t,a.indexInRow=0,a;var r=Math.min(Math.floor(t/i),a.row.items.length-1);return a.item=a.row.items[r],a.xOffset=t-r*i,a.indexInRow=r,a}var f=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={dropTargetIndex:null},e.rows=[],e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"itemAt",value:function(e,t){for(var n=0,i=0,a=null,r=null,o=0;o<this.flattenedList.length;o++){var l=this.flattenedList[o];if(!l.removing){for(var s=o,c=this.flattenedList[++s];c&&c.removing;)c=this.flattenedList[++s];var u=this.props.itemHeight,d=this.props.itemWidth;if(0===l.level&&(a=o,r=l,u=this.props.rootItemHeight,d=1e3),e>n&&e<n+d&&t>i&&t<i+u)return{item:l,index:o,xOffset:e-n,yOffset:t-i};if(c&&0===c.level&&e>n+d&&t>i&&t<i+u)return{item:r,index:a,xOffset:0,yOffset:0};0===l.level?(n=0,i+=u):((n+=d)>=d*this.props.numCols||c&&0===c.level)&&(n=0,i+=u)}}return null}},{key:"startDrag",value:function(e,t){var n=p(this.rows,e,t,this.props.itemWidth);if(console.log(n),n){var i=Object(h.a)({},n.item,{parentId:n.row.parentItemId,level:n.row.level,x:e-n.xOffset,y:t-n.yOffset,xOffset:n.xOffset,yOffset:n.yOffset});0!==i.level&&(this.setState({draggedItem:i}),this.continueDrag(e,t,i))}}},{key:"continueDrag",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.draggedItem,i=Object(h.a)({},n,{x:e-n.xOffset,y:t-n.xOffset});this.setState({draggedItem:i});var a=p(this.rows,e,t,this.props.itemWidth);console.log(a);var r=null,o=null,l=null;a&&a.item&&(o=a.item,r=a.item.id,l=this.props.willAcceptDrop(a.item,i,a.xOffset,a.yOffset,this.props.itemWidth,this.props.itemHeight)),r!==this.state.dropTargetId||l!==this.state.dropType?this.setState({draggedItem:i,dropTargetId:r,dropTargetItem:o,dropType:l}):this.setState({draggedItem:i}),console.log(r+": "+l)}},{key:"endDrag",value:function(e,t){this.state.dropType&&this.props.handleMove(this.state.dropTargetItem,this.state.draggedItem,this.state.dropType),this.setState({draggedItem:null,dropTargetId:null,dropType:null})}},{key:"updateRows",value:function(){for(var e=(new Date).getTime(),t=this.props.sections,n=this.state,i=(n.draggedItem,n.dropTargetId,n.dropType,this.rows||[]),a=[],r=0;r<i.length;r++)a[i[r].id]=i[r];for(var o=function(e,t,n,i,a){var r=[];function o(e,a,o,l){var s={parentItemId:a,items:e,level:l};1!==e.length||1!==t&&a?s.id=(a||"row")+"-"+o:s.id=e[0].id,s.height=a?i:n,0!==s.height&&r.push(s)}return function e(n,i,a){if(n&&0!==n.length)for(var r=[],l=0,s=0;s<n.length;s++){var c=n[s];r.push(c);var u=n[s+1];if(r.length>=t||!a||!u){o(r,a,++l,i);for(var d=0;d<r.length;d++){var h=r[d];h.children&&!h.collapsed&&e(h.children,i+1,h.id)}r=[]}}}(e,0),r}(t,this.props.numCols||1,this.props.rootItemHeight,this.props.itemHeight||200,this.props.itemWidth),l=[],s=i.map(function(e){return e.id}),c=o.map(function(e){return e.id}),u=0,d=0;u<o.length;)if(a[o[u].id]){for(;d<s.length&&s[d]!==c[u];)c.indexOf(s[d])<0&&!(i[d].removed<e-1e3)&&l.push(Object(h.a)({removed:e},i[d],{removing:!0})),d++;l.push(o[u]),u++,d++}else l.push(o[u]),u++;for(;d<s.length;)c.indexOf(s[d])<0&&!(i[d].removed<e-1e3)&&l.push(Object(h.a)({removed:e},i[d],{removing:!0})),d++;return this.rows=l,console.log(l),l}},{key:"render",value:function(){return null}}]),t}(i.Component),v=n(7),g=n.n(v),O=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state=e.getInitialAnimatedState(),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getInitialAnimatedState",value:function(){throw new Error("getInitialAnimatedState not implemented")}},{key:"animateDragStart",value:function(){}},{key:"animateDragEnd",value:function(){}},{key:"componentDidMount",value:function(){this.animateDragStart()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){return null}}]),t}(i.Component),b=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.item;return a.a.createElement("div",null,e.title)}}]),t}(i.Component),j=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getInitialAnimatedState",value:function(){return{animOpacity:new g.a.Value(0)}}},{key:"animateDragStart",value:function(){g.a.timing(this.state.animOpacity,{toValue:1,duration:500}).start()}},{key:"animateDragEnd",value:function(){}},{key:"componentDidMount",value:function(){this.animateDragStart()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.item,n=(e.toggleSection,e.numCols,e.isDropTarget,this.props.itemComponent||b);return t?a.a.createElement(g.a.div,{className:"draggeditem",style:{left:t.x,top:t.y,opacity:this.state.animOpacity}},a.a.createElement(n,this.props)):null}}]),t}(O),y=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state=e.getInitialAnimatedState(),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getInitialAnimatedState",value:function(){throw new Error("getInitialAnimatedState not implemented")}},{key:"animateAdd",value:function(){}},{key:"animateRemove",value:function(){}},{key:"componentDidMount",value:function(){this.animateAdd()}},{key:"componentDidUpdate",value:function(){this.props.row.removing?this.animateRemove():this.animateAdd()}},{key:"renderPlaceholder",value:function(){throw new Error("renderPlaceholder not implemented")}},{key:"renderHeader",value:function(){throw new Error("renderPlaceholder not implemented")}},{key:"renderItem",value:function(){throw new Error("renderPlaceholder not implemented")}},{key:"render",value:function(){return null}}]),t}(i.Component),w=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state=e.getInitialAnimatedState(),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getInitialAnimatedState",value:function(){throw new Error("getInitialAnimatedState not implemented")}},{key:"animateAdd",value:function(){}},{key:"animateRemove",value:function(){}},{key:"componentDidMount",value:function(){this.animateAdd()}},{key:"componentDidUpdate",value:function(){this.props.item.removing?this.animateRemove():this.animateAdd()}},{key:"renderPlaceholder",value:function(){throw new Error("renderPlaceholder not implemented")}},{key:"renderHeader",value:function(){throw new Error("renderPlaceholder not implemented")}},{key:"renderItem",value:function(){throw new Error("renderPlaceholder not implemented")}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.level;return"placeholder"===t.id?this.renderPlaceholder():0===n?this.renderHeader():n>=0?this.renderItem():null}}]),t}(i.Component),k=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.item;return a.a.createElement("div",{className:"ssli ssli-"+e.level,style:{width:e.removing?0:150,height:e.removing?0:this.props.itemHeight}})}}]),t}(function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return null}}]),t}(i.Component)),I=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getInitialAnimatedState",value:function(){return{animWidth:new g.a.Value(0),animOpacity:new g.a.Value(0),animHeight:new g.a.Value(0)}}},{key:"animateAdd",value:function(){g.a.timing(this.state.animOpacity,{toValue:1,duration:500}).start(),g.a.timing(this.state.animWidth,{toValue:150,duration:500}).start(),g.a.timing(this.state.animHeight,{toValue:this.props.itemHeight,duration:500}).start()}},{key:"animateRemove",value:function(){g.a.timing(this.state.animOpacity,{toValue:0,duration:500}).start(),g.a.timing(this.state.animWidth,{toValue:0,duration:500}).start(),g.a.timing(this.state.animHeight,{toValue:0,duration:500}).start()}},{key:"renderPlaceholder",value:function(){var e=this.props.placeholderComponent||k;return a.a.createElement(e,this.props)}},{key:"renderHeader",value:function(){var e=this.props,t=e.item,n=e.toggleSection,i=this.props.headerComponent||b;return a.a.createElement("div",{className:"ssli ssli-"+t.level,onClick:function(){return n(t)}},a.a.createElement(i,this.props))}},{key:"renderItem",value:function(){var e=this.props,t=e.item,n=e.toggleSection,i=e.level,r=this.props.itemComponent||b;return a.a.createElement(g.a.div,{className:"ssli ssli-"+i,style:{opacity:this.state.animOpacity,width:this.state.animWidth,height:this.state.animHeight},onClick:function(){return n(t)}},a.a.createElement(r,this.props))}}]),t}(w),E=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getInitialAnimatedState",value:function(){return{animOpacity:new g.a.Value(0),animHeight:new g.a.Value(0)}}},{key:"animateAdd",value:function(){g.a.timing(this.state.animOpacity,{toValue:1,duration:500}).start(),g.a.timing(this.state.animHeight,{toValue:this.props.row.height,duration:500}).start()}},{key:"animateRemove",value:function(){g.a.timing(this.state.animOpacity,{toValue:0,duration:500}).start(),g.a.timing(this.state.animHeight,{toValue:0,duration:500}).start()}},{key:"render",value:function(){var e=this,t=this.props.row;return a.a.createElement(g.a.div,{className:"sslr sslr-"+t.level,style:{opacity:this.state.animOpacity,height:this.state.animHeight}},t.items.map(function(n,i){return a.a.createElement(I,Object.assign({},e.props,{isDropTarget:e.state.dropTarget&&e.state.dropTarget.indexInRow===i,key:n.id,item:n,level:t.level}))}))}}]),t}(y),D=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).onMouseDown=e.onMouseDown.bind(Object(m.a)(Object(m.a)(e))),e.onMouseMove=e.onMouseMove.bind(Object(m.a)(Object(m.a)(e))),e.onMouseUp=e.onMouseUp.bind(Object(m.a)(Object(m.a)(e))),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"onMouseDown",value:function(e){if(!this.state.draggedItem){var t=e.pageX-this.containerElement.offsetLeft,n=e.pageY-this.containerElement.offsetTop;this.startDrag(t,n)}}},{key:"onMouseMove",value:function(e){if(this.state.draggedItem){var t=e.pageX-this.containerElement.offsetLeft,n=e.pageY-this.containerElement.offsetTop;this.continueDrag(t,n)}}},{key:"onMouseUp",value:function(e){this.state.draggedItem&&this.endDrag()}},{key:"render",value:function(){var e=this,t=this.state.draggedItem,n=this.updateRows();return a.a.createElement("div",{ref:function(t){e.containerElement=t},className:"sectionlist "+this.props.className,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp},n.map(function(t,n){return a.a.createElement(E,Object.assign({},e.props,{isDropTarget:e.state.dropTarget&&e.state.dropTarget.rowIndex===n,key:t.id,row:t}))}),a.a.createElement(j,Object.assign({},this.props,{item:t})))}}]),t}(f),S=n(20),M=[{id:"s1",title:"Title1",children:["item1","item2"]},{id:"s2",title:"Title2",children:[{id:"s4",title:"Subfolder",children:["item7","item8"]},"item3","item4"]},{id:"s3",title:"Title3",children:["item5","item6"]}],A=[{id:"s1",title:"First Section",children:["item1","item2"]},{id:"s2",title:"Second Section",children:["item2a","item2b","item2c","item2d"]},{id:"s3",title:"Third Section",children:["item3","item4","item7","item8","item9","item10"]},{id:"s4",title:"Fourth Section",children:["item5","item6"]}];function T(e,t){for(var n=0;n<e.length;n++){if(t(e[n]))return e[n];if(e[n].children){var i=T(e[n].children,t);if(i)return i}}return null}function x(e,t,n){if(e.id===t)return n(e);if("object"!==typeof e)return e;if(!e.children||0===e.children.length)return e;for(var i=e.children.map(function(e){return x(e,t,n)}),a=0;a<i.length;a++)if(i[a]!==e.children[a])return Object(h.a)({},e,{children:i});return e}function C(e,t,n,i){var a=n.parentId,r=null;if(null!==i){if(r="into"===i?t.id:t.parentId,t.id===n.id)return e;if(n.children)if(T(n.children,function(e){return e.id===t.id}))return e;var o=T(e,function(e){return e.id===a}),l=T(e,function(e){return e.id===r});console.log("Moving"),console.log(o),console.log(l);var s=Object(S.a)(o.children||[]),c=a===r?s:Object(S.a)(l.children||[]),u=s.find(function(e){return e===n.title||e.id===n.id});if(u){if("into"===i)s.splice(s.indexOf(u),1),c.push(Object(h.a)({},u,{parentId:r}));else{s.splice(s.indexOf(u),1);var d=c.find(function(e){return e===t.title||e.id===t.id});"before"===i?c.splice(c.indexOf(d),0,Object(h.a)({},u,{parentId:r})):"after"===i&&c.splice(c.indexOf(d)+1,0,Object(h.a)({},u,{parentId:r}))}return c=c.map(function(e){return x(e,a,function(e){return Object(h.a)({},e,{children:s})})}),e.map(function(e){return x(e,a,function(e){return Object(h.a)({},e,{children:s})})}).map(function(e){return x(e,r,function(e){return Object(h.a)({},e,{children:c})})})}console.warn("original item not found")}}function H(e,t,n){if("string"===typeof e)return{id:(t||"item")+"-"+n,title:e,parentId:t};if(Array.isArray(e))return e.map(function(e,n){return H(e,t,n)});if("object"===typeof e){var i=Object(h.a)({parentId:t},e);return e.id||(i.id=(t||"item")+"-"+n),e.children&&(i.children=H(e.children,i.id)),i}return e}var N=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.item;return a.a.createElement("div",{className:"sectionheader"},e.title)}}]),t}(i.Component),V=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.item;return a.a.createElement("div",{className:"draggablethumb"},"Thumb ",e.title)}}]),t}(i.Component),R=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={sections:H(A)},console.log(e.state.sections),e.toggleSection=e.toggleSection.bind(Object(m.a)(Object(m.a)(e))),e.handleMove=e.handleMove.bind(Object(m.a)(Object(m.a)(e))),e.willAcceptDrop=e.willAcceptDrop.bind(Object(m.a)(Object(m.a)(e))),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"toggleSection",value:function(e){var t=this.state.sections.map(function(t){return x(t,e.id,function(e){return Object(h.a)({},e,{collapsed:!e.collapsed})})});this.setState({sections:t})}},{key:"willAcceptDrop",value:function(e,t,n,i){return void 0===e.parentId?"into":n<75?"before":n>=75?"after":null}},{key:"handleMove",value:function(e,t,n){console.log("Dropping "+t.title+" "+n+" "+e.title),this.setState({sections:C(this.state.sections,e,t,n)})}},{key:"render",value:function(){var e=this.state.sections;return a.a.createElement(D,{className:"grid",numCols:4,itemWidth:150,itemHeight:200,rootItemHeight:40,toggleSection:this.toggleSection,headerComponent:N,itemComponent:V,willAcceptDrop:this.willAcceptDrop,handleMove:this.handleMove,sections:e})}}]),t}(i.Component),W=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.item;return e.children?a.a.createElement("div",null,e.collapsed?"+":"-"," ",e.title):a.a.createElement("div",null,e.title)}}]),t}(i.Component),P=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={treeNodes:H(M)},e.toggleTreeNode=e.toggleTreeNode.bind(Object(m.a)(Object(m.a)(e))),e.handleMove=e.handleMove.bind(Object(m.a)(Object(m.a)(e))),e.willAcceptDrop=e.willAcceptDrop.bind(Object(m.a)(Object(m.a)(e))),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"toggleTreeNode",value:function(e){var t=this.state.treeNodes.map(function(t){return x(t,e.id,function(e){return Object(h.a)({},e,{collapsed:!e.collapsed})})});this.setState({treeNodes:t})}},{key:"willAcceptDrop",value:function(e,t,n,i,a,r){return e.id===t.id?null:void 0===e.parentId?"into":i<7?"before":i>=7&&i<23?"into":i>=23?"after":null}},{key:"handleMove",value:function(e,t,n){console.log("Dropping "+t.title+" "+n+" "+e.title),this.setState({treeNodes:C(this.state.treeNodes,e,t,n)})}},{key:"render",value:function(){var e=this.state.treeNodes;return a.a.createElement(D,{className:"tree",numCols:1,itemWidth:200,itemHeight:30,rootItemHeight:30,toggleSection:this.toggleTreeNode,willAcceptDrop:this.willAcceptDrop,handleMove:this.handleMove,headerComponent:W,itemComponent:W,sections:e})}}]),t}(i.Component),U=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement("h1",null,"React Sortable Section List"),a.a.createElement("p",null,"Intro..."),a.a.createElement("h2",null,"Tree"),a.a.createElement("p",null,"As a tree.."),a.a.createElement(P,null),a.a.createElement("h2",null,"Grid"),a.a.createElement("p",null,"As a grid..."),a.a.createElement(R,null))}}]),t}(i.Component);o.a.render(a.a.createElement(U,null),document.getElementById("root"))}},[[27,2,1]]]);
//# sourceMappingURL=main.28715dab.chunk.js.map